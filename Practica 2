CREATE TABLE Examenes (
    IdExamen INT PRIMARY KEY,
    IdAlumno INT,
    NombreAlumno VARCHAR(100),
    Curso VARCHAR(50),
    FechaExamen DATE,
    HoraInicio DATETIME,
    HoraFin DATETIME,
    Nota DECIMAL(4,2)
);DECLARE @CursoFiltro VARCHAR(50) = 'Matem√°ticas';
DECLARE @FechaInicio DATE = '2025-11-01';
DECLARE @FechaFin DATE = '2025-11-15';

SELECT 
    Curso,
    COUNT(*) AS TotalExamenes,
    MIN(Nota) AS NotaMinima,
    MAX(Nota) AS NotaMaxima,
    AVG(Nota) AS PromedioNotas,
    MIN(HoraInicio) AS ExamenMasTemprano,
    MAX(HoraFin) AS ExamenMasTardio,
    AVG(DATEDIFF(MINUTE, HoraInicio, HoraFin)) AS PromedioDuracionMinutos,
    FORMAT(MIN(FechaExamen), 'dddd dd MMM yyyy') AS PrimeraFechaFormateada,
    FORMAT(MAX(FechaExamen), 'dddd dd MMM yyyy') AS UltimaFechaFormateada
FROM Examenes
WHERE Curso = @CursoFiltro
  AND FechaExamen BETWEEN @FechaInicio AND @FechaFin
GROUP BY Curso
ORDER BY PromedioNotas DESC;
