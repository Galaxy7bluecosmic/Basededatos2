-- Crear tabla de usuarios con contraseña hasheada
CREATE TABLE Usuarios (
    UsuarioID INT PRIMARY KEY,
    NombreUsuario NVARCHAR(50),
    ContraseñaHash VARBINARY(64)
);

-- Insertar una contraseña usando SHA-256
DECLARE @Contraseña NVARCHAR(100) = 'MiContraseñaSegura123';
INSERT INTO Usuarios (UsuarioID, NombreUsuario, ContraseñaHash)
VALUES (
    1,
    'usuario1',
    HASHBYTES('SHA2_256', CONVERT(VARBINARY(100), @Contraseña))
);

-- Verificar contraseña (ejemplo de comparación)
DECLARE @Intento NVARCHAR(100) = 'MiContraseñaSegura123';
SELECT *
FROM Usuarios
WHERE NombreUsuario = 'usuario1'
  AND ContraseñaHash = HASHBYTES('SHA2_256', CONVERT(VARBINARY(100), @Intento));
-- Crear tabla con contraseña cifrada
CREATE TABLE UsuariosSeguros (
    UsuarioID INT PRIMARY KEY,
    NombreUsuario NVARCHAR(50),
    ContraseñaCifrada VARBINARY(MAX)
);

-- Insertar una contraseña cifrada
DECLARE @FraseSecreta NVARCHAR(128) = 'MiFraseDeCifradoSegura';
DECLARE @Contraseña NVARCHAR(100) = 'Clave123!';
INSERT INTO UsuariosSeguros (UsuarioID, NombreUsuario, ContraseñaCifrada)
VALUES (
    1,
    'usuario2',
    EncryptByPassPhrase(@FraseSecreta, @Contraseña)
);

-- Recuperar la contraseña (solo si tienes la frase secreta)
DECLARE @FraseSecreta NVARCHAR(128) = 'MiFraseDeCifradoSegura';
SELECT 
    UsuarioID,
    NombreUsuario,
    CONVERT(NVARCHAR(100), DecryptByPassPhrase(@FraseSecreta, ContraseñaCifrada)) AS ContraseñaRecuperada
FROM UsuariosSeguros;
