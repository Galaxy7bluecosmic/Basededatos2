CREATE TABLE Examenes (
    IdExamen INT PRIMARY KEY,
    IdAlumno INT,
    NombreAlumno VARCHAR(100),
    Curso VARCHAR(50),
    FechaExamen DATE,
    HoraInicio DATETIME,
    HoraFin DATETIME,
    Nota DECIMAL(4,2)
);DECLARE @CursoFiltro VARCHAR(50) = 'Matem√°ticas';
DECLARE @FechaInicio DATE = '2025-11-01';
DECLARE @FechaFin DATE = '2025-11-15';

SELECT 
    Curso,
    COUNT(*) AS TotalExamenes,
    MIN(Nota) AS NotaMinima,
    MAX(Nota) AS NotaMaxima,
    AVG(Nota) AS PromedioNotas,
    MIN(HoraInicio) AS ExamenMasTemprano,
    MAX(HoraFin) AS ExamenMasTardio,
    AVG(DATEDIFF(MINUTE, HoraInicio, HoraFin)) AS PromedioDuracionMinutos,
    FORMAT(MIN(FechaExamen), 'dddd dd MMM yyyy') AS PrimeraFechaFormateada,
    FORMAT(MAX(FechaExamen), 'dddd dd MMM yyyy') AS UltimaFechaFormateada
FROM Examenes
WHERE Curso = @CursoFiltro
  AND FechaExamen BETWEEN @FechaInicio AND @FechaFin
GROUP BY Curso
ORDER BY PromedioNotas DESC;

CREATE TABLE Pagos (
    IdPago INT PRIMARY KEY,
    Cliente VARCHAR(100),
    Categoria VARCHAR(50),       -- Ej: 'Servicios', 'Productos'
    FechaPago DATE,
    HoraPago DATETIME,
    Monto DECIMAL(12,2),
    MetodoPago VARCHAR(30)       -- Ej: 'Tarjeta', 'Transferencia', 'Efectivo'
);
DECLARE @FechaInicio DATE = '2025-11-01';
DECLARE @FechaFin DATE = '2025-11-30';
DECLARE @CategoriaFiltro VARCHAR(50) = 'Servicios';

SELECT 
    Categoria,
    MetodoPago,
    COUNT(*) AS TotalPagos,
    SUM(Monto) AS MontoTotal,
    MIN(Monto) AS PagoMinimo,
    MAX(Monto) AS PagoMaximo,
    AVG(Monto) AS PromedioPago,
    MIN(HoraPago) AS PrimerPagoDelDia,
    MAX(HoraPago) AS UltimoPagoDelDia,
    FORMAT(MIN(FechaPago), 'dd/MM/yyyy') AS PrimeraFecha,
    FORMAT(MAX(FechaPago), 'dd/MM/yyyy') AS UltimaFecha,
    AVG(DATEDIFF(MINUTE, CAST(FechaPago AS DATETIME), HoraPago)) AS PromedioMinutosDesdeMedianoche
FROM Pagos
WHERE FechaPago BETWEEN @FechaInicio AND @FechaFin
  AND Categoria = @CategoriaFiltro
GROUP BY Categoria, MetodoPago
ORDER BY MontoTotal DESC, PromedioPago DESC;

From Pagos
where FechaPago if @FechaInico< 20
grup by categoria, metododepago
order by montoTotal;
